<bootstrap-input-group>
    <div class="input-group">
      <input ref="text" type="text" class="form-control" placeholder="{opts.placeholder}">
      <span class="input-group-btn">
        <button class="btn btn-default" type="button" onclick="{fn.search}">{opts.btn}</button>
      </span>
    </div><!-- /input-group -->

    <script type="text/javascript">
        // TODO: On clicking 'enter' in the search field, trigger "fn.search"
        var tag = this;
        var defaults = {
            placeholder: "Search for...",
            btn: "Go!",
            trigger:"search"
        };
        tag.on('mount', function(){
            tag.opts = _.defaults(tag.opts, defaults);
        });

        (function(fn){
            fn.search = function(e){
                tag.parent.trigger(tag.opts.trigger, tag, e);
            }
        }(tag.fn = tag.fn || {}));

    </script>
</bootstrap-input-group>

<bootstrap-input-text>
    <label>{ opts.label || 'label' } ({opts.path})</label>
    <input value={val} oninput="{on_input}" type="text" placeholder="{opts.placeholder || 'placeholder'}">
    <script>
        var tag=this;
        tag.on_input = function(e){tag.parent.trigger('on_child_input', e, tag)};
        tag.on('update', function(i){
            tag.val = _.get(tag.parent.message, tag.opts.path)
        })

    </script>
</bootstrap-input-text>

<bootstrap-tags>
    <virtual each="{tag in opts.tags}">
        <a class="btn btn-sm btn-primary">{tag}</a>
    </virtual>
</bootstrap-tags>

<bootstrap-languages>
    <h4>Name</h4>
    <p >{code} : {value}</p>

    <div class="input-group" each="{value, code in things}">
      <span class="input-group-addon">{code}</span>
      <input type="text" class="form-control" value={value} aria-label="Text for language {code}">
    </div>

    <div class="dropdown">
      <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
        Add name
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu">
        <li onclick="{add.en}"><a href="#">En</a></li>
        <li onclick="{add.tet}"><a href="#">Tet</a></li>
        <li onclick="{add.ind}"><a href="#">Ind</a></li>
        <li onclick="{add.pt}"><a href="#">Pt</a></li>
      </ul>
    </div>

    <script>
        var tag = this;
        tag.things = {};
        tag.message = {};
        tag.on('mount', function(){console.log(tag.opts.path); debugger})
        tag.on_child_input = function(e, _tag){tag.parent.trigger('on_child_input', e, _tag)};
        tag.on('update', function(i){
            tag.message = tag.parent.message;
            tag.things = _.get(tag.parent.message, tag.opts.path);
        });

        tag.add = {};
        var languages = ['en', 'pt', 'ind', 'tet'];
        _(languages).each(function(l){
            tag.add[l] = function(e){e.preventDefault(); tag.trigger('add_language', l)}
        });

        tag.on('add_language', function(code){
            debugger;
            tag.parent.message.name[code] = '';
            tag.parent.update();
        })



    </script>

</bootstrap-languages>